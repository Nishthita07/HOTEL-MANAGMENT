CREATE TABLE BOOKING( 
BOOKING_ID NUMBER PRIMARY KEY, 
GUEST_ID NUMBER, 
ROOM_NO NUMBER, 
CHECKIN_DATE DATE, 
CHECKOUT_DATE DATE, 
HOTEL_ID NUMBER, 
TOTAL_PRICE DECIMAL(10,2), 
STATUS VARCHAR(20)); 

CREATE TABLE PAYMENT( 
PAYMENT_ID NUMBER PRIMARY KEY, 
BOOKING_ID NUMBER, 
AMOUNT DECIMAL(10,2), 
PAYMENT_DATE DATE, 
PAYMENT_METHOD VARCHAR(50)); 
CREATE TABLE GUEST_DETAILS( 
GUEST_ID NUMBER PRIMARY KEY, 
FIRST_NAME VARCHAR(50), 
LAST_NAME VARCHAR(50), 
DOB DATE, 
ADDRESS VARCHAR(255), 
PHONE VARCHAR(10), 
EMAIL VARCHAR(100));

CREATE TABLE HOTEL( 
    HOTEL_ID NUMBER PRIMARY KEY, 
    NAME VARCHAR(50), 
   ADDRESS VARCHAR(50), 
   PHONE  NUMBER(10), 
   EMAIL VARCHAR(30), 
   STARS  NUMBER(7) 
   ); 

CREATE TABLE HOTEL( 
    HOTEL_ID NUMBER PRIMARY KEY, 
    NAME VARCHAR(50), 
   ADDRESS VARCHAR(50), 
   PHONE  NUMBER(10), 
   EMAIL VARCHAR(30), 
   STARS  NUMBER(7) 
   ); 

CREATE TABLE ROOMS ( 
    ROOM_NO NUMBER, 
    HOTEL_ID NUMBER,    
    STATUS VARCHAR(30), 
    TYPE_ID NUMBER(10), 
    PRIMARY KEY(ROOM_NO,HOTEL_ID)
);

CREATE TABLE ROOM_TYPE ( 
    TYPE_ID NUMBER PRIMARY KEY, 
    NAME VARCHAR2(50), 
    PRICE_PER_NIGHT NUMBER, 
    CAPACITY NUMBER  );  

ALTER TABLE STAFF_DETAILS  
ADD CONSTRAINT PHONE_CONST 
CHECK (LENGTH(PHONE) =10); 
ALTER TABLE STAFF_DETAILS 
ADD CONSTRAINT CHK_EMAIL_STAFF 
CHECK (EMAIL LIKE '%_@__%.__%'); 
 
ALTER TABLE STAFF_DETAILS 
ADD CONSTRAINT FK_STAFF 
FOREIGN KEY (HOTEL_ID) 
REFERENCES HOTEL(HOTEL_ID); 
ALTER TABLE GUEST_DETAILS 
ADD CONSTRAINT CHK_EMAIL_GUEST 
CHECK (EMAIL LIKE '%_@__%.__%'); 
ADD CONSTRAINT PHONE_CONSTRT 
CHECK (LENGTH(PHONE) =10);

ALTER TABLE ROOMS 
ADD CONSTRAINT FK_HOTEL_ID 
FOREIGN KEY (HOTEL_ID) 
REFERENCES HOTEL(HOTEL_ID); 
ADD CONSTRAINT FK_ROOMS 
FOREIGN KEY (TYPE_ID) 
REFERENCES ROOM_TYPE(TYPE_ID); 
ADD CONSTRAINT FK_GUEST_MONEY 
FOREIGN KEY (GUEST_ID) 
REFERENCES GUEST_DETAILS(GUEST_ID); 
 
ALTER TABLE BOOKING 
ADD CONSTRAINT FK_ROOM 
FOREIGN KEY(ROOM_NO,HOTEL_ID) 
REFERENCES ROOMS(ROOM_NO,HOTEL_ID); 
ADD CONSTRAINT CHECK_TOTAL_PRICE 
CHECK (TOTAL_PRICE > 0);
ALTER TABLE BOOKING 
ADD CONSTRAINT CHECK_STATUS 
CHECK (UPPER(STATUS) IN ('ACTIVE', 'CANCELLED', 'COMPLETED'));
ADD CONSTRAINT CHECK_STATUS_ROOMS 
CHECK (UPPER(STATUS) IN ('AVAILABLE', 'BOOKED'));

